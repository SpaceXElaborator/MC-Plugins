package com.terturl.MeleeCraftEssentials;import com.terturl.MeleeCraftEssentials.Commands.CommandMeta;import com.terturl.MeleeCraftEssentials.Database.MCDatabase;import com.terturl.MeleeCraftEssentials.Database.MCDatabaseManager;import com.terturl.MeleeCraftEssentials.Player.Mail.Commands.MailCommand;import com.terturl.MeleeCraftEssentials.Player.Mail.MailDB;import com.terturl.MeleeCraftEssentials.Player.MeleeCoinDB;import com.terturl.MeleeCraftEssentials.Utils.ConfigHandler;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.util.Arrays;import org.bukkit.Bukkit;import org.bukkit.command.Command;import org.bukkit.command.CommandExecutor;import org.bukkit.command.CommandMap;import org.bukkit.command.PluginCommand;import org.bukkit.command.TabCompleter;import org.bukkit.configuration.file.YamlConfiguration;import org.bukkit.event.Listener;import org.bukkit.plugin.Plugin;import org.bukkit.plugin.PluginManager;import org.bukkit.plugin.java.JavaPlugin;public class MCEssentials extends JavaPlugin {  private static MCEssentials instance;    private MCDatabaseManager dbManager;    private ConfigHandler configManager;    public void onEnable() {    instance = this;    this.configManager = new ConfigHandler(this);    if (this.configManager.firstLoad());    YamlConfiguration config = this.configManager.loadConfig("database.yml");    this.dbManager = new MCDatabaseManager(config.getString("User"), config.getString("Pass"),         config.getString("Host"), config.getString("DBName"));    registerDatabase((MCDatabase)new MeleeCoinDB());    registerDatabase((MCDatabase)new MailDB());    registerCommand(new MailCommand());  }    public void onDisable() {}    public static MCEssentials getInstance() {    return instance;  }    public void registerDatabase(MCDatabase mc) {    getDBManager().registerDatabase(mc);  }    public MCDatabaseManager getDBManager() {    return this.dbManager;  }    public ConfigHandler getConfiguration() {    return this.configManager;  }    public <T extends com.terturl.MeleeCraftEssentials.Commands.CraftCommand> void registerCommand(T command) {    PluginCommand pg = getCommand(command.getName());    if (pg == null) {      try {        Constructor<PluginCommand> cConstructor = PluginCommand.class.getDeclaredConstructor(new Class[] { String.class, Plugin.class });        cConstructor.setAccessible(true);        pg = cConstructor.newInstance(new Object[] { command.getName(), this });      } catch (Exception e) {        e.printStackTrace();      }       CommandMap cm = null;      try {        PluginManager pm = Bukkit.getPluginManager();        Field cMapField = pm.getClass().getDeclaredField("commandMap");        cMapField.setAccessible(true);        cm = (CommandMap)cMapField.get(pm);      } catch (Exception e) {        e.printStackTrace();      }       CommandMeta anno = command.getClass().<CommandMeta>getAnnotation(CommandMeta.class);      if (anno != null) {        pg.setAliases(Arrays.asList(anno.aliases()));        pg.setDescription(anno.description());        pg.setUsage(anno.usage());      }       cm.register(getDescription().getName(), (Command)pg);    }     pg.setExecutor((CommandExecutor)command);    pg.setTabCompleter((TabCompleter)command);  }    public <T extends Listener> T registerListener(T listener) {    Bukkit.getPluginManager().registerEvents((Listener)listener, (Plugin)this);    return listener;  }}